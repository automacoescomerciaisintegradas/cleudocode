# ============================================ 
# CLEUDO CODE - Dockerfile para o Sandbox de Agentes
# ============================================ 

FROM python:3.11-slim

# Metadados
LABEL maintainer="cleudocode.automacoescomerciais.com.br"
LABEL version="0.50.0"
LABEL description="CLEUDO CODE - Sandbox para Execução de Agentes"

# Variáveis de ambiente
ENV PYTHONDONTWRITEBYTECODE=1
ENV PYTHONUNBUFFERED=1
ENV PYTHONPATH="/app"

# Diretório de trabalho
WORKDIR /app

# Instalar dependências do sistema (mínimas)
RUN apt-get update && apt-get install -y --no-install-recommends \
    curl \
    && rm -rf /var/lib/apt/lists/*

# Copiar requirements para o sandbox
COPY requirements.txt .

# Instalar dependências Python
RUN pip install --no-cache-dir --upgrade pip && \
    pip install --no-cache-dir -r requirements.txt

# Copiar o código necessário para os agentes
COPY ./skills ./skills
COPY ./core ./core
COPY ./tool_box.py .
COPY ./sandbox_runner.py .

# Criar o diretório que será montado como volume, para garantir que ele exista
# com as permissões corretas caso o volume ainda não tenha sido criado pelo Docker.
RUN mkdir -p /app/sandbox

# Comando para manter o container em execução, aguardando comandos
CMD ["tail", "-f", "/dev/null"]
