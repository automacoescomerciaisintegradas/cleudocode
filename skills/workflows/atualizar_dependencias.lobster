name: "AtualizaÃ§Ã£o de DependÃªncias"
description: "Verifica e atualiza dependÃªncias do projeto"
version: "1.0"
author: "Cleudocode Team"

steps:
  - name: "Listar dependÃªncias atuais"
    skill: "shell"
    action: "execute"
    params:
      command: "pip list --format=freeze"
    continue_on_error: true
    
  - name: "Verificar dependÃªncias desatualizadas"
    skill: "shell"
    action: "execute"
    params:
      command: "pip list --outdated"
    continue_on_error: true
    
  - name: "Criar backup do requirements"
    skill: "shell"
    action: "execute"
    params:
      command: "copy requirements.txt requirements.txt.backup_{{ date }}"
    continue_on_error: true
    
  - name: "Gerar novo requirements"
    skill: "shell"
    action: "execute"
    params:
      command: "pip freeze > requirements_new.txt"
    continue_on_error: false
    
  - name: "Criar relatÃ³rio de atualizaÃ§Ãµes"
    skill: "filesystem"
    action: "write_file"
    params:
      filepath: "reports/atualizacoes_{{ date }}.md"
      content: |
        # RelatÃ³rio de AtualizaÃ§Ãµes - {{ date }}
        
        ## ğŸ“¦ DependÃªncias Atuais
        
        ```
        {{ step_0_result.stdout }}
        ```
        
        ## ğŸ”„ DependÃªncias Desatualizadas
        
        ```
        {{ step_1_result.stdout }}
        ```
        
        ## âœ… AÃ§Ãµes Realizadas
        
        - [x] Backup criado: `requirements.txt.backup_{{ date }}`
        - [x] Novo requirements gerado: `requirements_new.txt`
        - [x] RelatÃ³rio criado
        
        ## ğŸ“‹ PrÃ³ximos Passos
        
        1. Revisar mudanÃ§as em `requirements_new.txt`
        2. Testar aplicaÃ§Ã£o com novas dependÃªncias
        3. Se OK, substituir `requirements.txt`
        4. Commitar mudanÃ§as no Git
        
        ## âš ï¸ Importante
        
        - Sempre teste antes de atualizar em produÃ§Ã£o
        - Mantenha backups dos requirements
        - Documente breaking changes
        
        ---
        
        *RelatÃ³rio gerado automaticamente*
      overwrite: true
    
  - name: "Notificar conclusÃ£o"
    skill: "telegram"
    action: "send_message"
    params:
      message: |
        ğŸ“¦ VerificaÃ§Ã£o de DependÃªncias ConcluÃ­da!
        
        ğŸ“… Data: {{ datetime }}
        
        âœ… AÃ§Ãµes realizadas:
        - Backup criado
        - Requirements atualizado
        - RelatÃ³rio gerado
        
        ğŸ“„ Verifique:
        reports/atualizacoes_{{ date }}.md
        
        âš ï¸ Revise antes de aplicar!
