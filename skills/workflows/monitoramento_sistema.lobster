name: "Monitoramento de Sa√∫de do Sistema"
description: "Verifica sa√∫de do sistema e alerta sobre problemas"
version: "1.0"
author: "Cleudocode Team"

steps:
  - name: "Verificar uso de disco"
    skill: "shell"
    action: "execute"
    params:
      command: "wmic logicaldisk get caption,freespace,size /format:list"
    continue_on_error: true
    
  - name: "Verificar uso de mem√≥ria"
    skill: "shell"
    action: "execute"
    params:
      command: "wmic OS get FreePhysicalMemory,TotalVisibleMemorySize /format:list"
    continue_on_error: true
    
  - name: "Verificar processos Python"
    skill: "shell"
    action: "execute"
    params:
      command: "tasklist | find \"python\""
    continue_on_error: true
    
  - name: "Verificar logs de erro recentes"
    skill: "shell"
    action: "execute"
    params:
      command: "powershell \"Get-Content logs\\cleudocode.log -Tail 100 | Select-String 'ERROR'\""
    continue_on_error: true
    
  - name: "Verificar conectividade"
    skill: "shell"
    action: "execute"
    params:
      command: "ping -n 1 8.8.8.8"
    continue_on_error: true
    
  - name: "Gerar relat√≥rio de sa√∫de"
    skill: "filesystem"
    action: "write_file"
    params:
      filepath: "reports/health_{{ datetime }}.txt"
      content: |
        ===================================
        RELAT√ìRIO DE SA√öDE DO SISTEMA
        ===================================
        
        Data/Hora: {{ datetime }}
        Timestamp: {{ timestamp }}
        
        DISCO:
        {{ step_0_result.stdout }}
        
        MEM√ìRIA:
        {{ step_1_result.stdout }}
        
        PROCESSOS PYTHON:
        {{ step_2_result.stdout }}
        
        ERROS RECENTES:
        {{ step_3_result.stdout }}
        
        CONECTIVIDADE:
        {{ step_4_result.stdout }}
        
        ===================================
        STATUS: {% if step_3_result.stdout %}‚ö†Ô∏è ATEN√á√ÉO{% else %}‚úÖ NORMAL{% endif %}
        ===================================
      overwrite: true
    
  - name: "Alertar se houver problemas"
    skill: "telegram"
    action: "send_message"
    params:
      message: |
        {% if step_3_result.stdout %}
        ‚ö†Ô∏è ALERTA DE SISTEMA!
        
        üî¥ Erros detectados no sistema
        üìÖ Data: {{ datetime }}
        
        Verifique o relat√≥rio:
        reports/health_{{ datetime }}.txt
        
        A√ß√£o recomendada:
        - Verificar logs detalhados
        - Investigar erros
        - Aplicar corre√ß√µes
        {% else %}
        ‚úÖ Sistema Saud√°vel
        
        üìÖ Data: {{ datetime }}
        üíö Todos os sistemas operando normalmente
        
        Relat√≥rio salvo em:
        reports/health_{{ datetime }}.txt
        {% endif %}
