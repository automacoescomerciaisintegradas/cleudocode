name: "Sincroniza√ß√£o com Git"
description: "Sincroniza projeto com reposit√≥rio Git"
version: "1.0"
author: "Cleudocode Team"

variables:
  branch: "main"
  commit_message: "Auto-commit: {{ datetime }}"

steps:
  - name: "Verificar status do Git"
    skill: "shell"
    action: "execute"
    params:
      command: "git status"
    continue_on_error: true
    
  - name: "Adicionar arquivos modificados"
    skill: "shell"
    action: "execute"
    params:
      command: "git add ."
    continue_on_error: false
    
  - name: "Criar commit"
    skill: "shell"
    action: "execute"
    params:
      command: "git commit -m \"{{ commit_message }}\""
    continue_on_error: true
    
  - name: "Pull das √∫ltimas altera√ß√µes"
    skill: "shell"
    action: "execute"
    params:
      command: "git pull origin {{ branch }}"
    retry: 2
    retry_delay: 3
    continue_on_error: true
    
  - name: "Push para o reposit√≥rio"
    skill: "shell"
    action: "execute"
    params:
      command: "git push origin {{ branch }}"
    retry: 2
    retry_delay: 3
    continue_on_error: true
    
  - name: "Verificar log recente"
    skill: "shell"
    action: "execute"
    params:
      command: "git log -5 --oneline"
    continue_on_error: true
    
  - name: "Criar relat√≥rio de sincroniza√ß√£o"
    skill: "filesystem"
    action: "write_file"
    params:
      filepath: "reports/git_sync_{{ date }}.txt"
      content: |
        ===================================
        SINCRONIZA√á√ÉO GIT
        ===================================
        
        Data: {{ datetime }}
        Branch: {{ branch }}
        Commit: {{ commit_message }}
        
        STATUS INICIAL:
        {{ step_0_result.stdout }}
        
        COMMITS RECENTES:
        {{ step_5_result.stdout }}
        
        RESULTADO:
        {% if step_4_result.success %}‚úÖ Push realizado com sucesso{% else %}‚ùå Erro no push{% endif %}
        
        ===================================
      overwrite: true
    
  - name: "Notificar resultado"
    skill: "telegram"
    action: "send_message"
    params:
      message: |
        {% if step_4_result.success %}
        ‚úÖ Git Sincronizado!
        {% else %}
        ‚ö†Ô∏è Problema na Sincroniza√ß√£o Git
        {% endif %}
        
        üìÖ Data: {{ datetime }}
        üåø Branch: {{ branch }}
        üí¨ Commit: {{ commit_message }}
        
        üìÑ Relat√≥rio: reports/git_sync_{{ date }}.txt
